# 딥러닝 실습 02: 피마 인디언 당뇨병 예측 (이진 분류 심화)

**파일**: `260107 딥러닝 02.py`
**데이터**: `pima-indians-diabetes3.csv` (당뇨병 발병 데이터)

## 1. 핵심 내용

이 코드는 `01.py`의 이진 분류 모델을 발전시킨 형태입니다.
**Pandas**를 이용한 데이터 분석/시각화가 추가되었고, 모델의 성능을 객관적으로 평가하기 위해 **학습용/테스트용 데이터 분리(Train-Test Split)** 과정을 도입했습니다.

## 2. 주요 코드 포인트

### (1) 데이터 로드 및 분석 (Pandas & Seaborn)

```python
df = pd.read_csv(file_path)         # DataFrame으로 로드
sns.heatmap(df.corr(), ...)         # 상관관계 시각화
plt.hist(x=[...], ...)              # 데이터 분포 확인
```

- 데이터를 무작정 학습시키기 전에, 어떤 속성이 중요한지 눈으로 확인하는 과정이 추가되었습니다.
- 예: `plasma`(혈장 포도당)와 `BMI`가 당뇨병과 상관관계가 높음을 확인.

### (2) 데이터 분리 (Train-Test Split) **[중요]**

```python
from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, shuffle=True, random_state=42
)
```

- **학습 데이터(80%)**: 모델 공부용 (`X_train`, `y_train`)
- **테스트 데이터(20%)**: 모델 평가용 (`X_test`, `y_test`)
- 모델이 '아는 문제'만 잘 푸는 것이 아니라, '처음 보는 문제'도 잘 푸는지 검증하기 위함입니다.

### (3) 모델 구조

```python
model.add(Dense(12, input_dim=8, activation='relu'))
model.add(Dense(8, activation='relu'))
model.add(Dense(1, activation='sigmoid'))
```

- 입력 속성이 8개이므로 `input_dim=8` (또는 `Input(shape=(8,))`)
- 출력은 여전히 당뇨/정상 이진 분류이므로 `Dense(1, activation='sigmoid')`

### (4) 평가 (Evaluation)

```python
score = model.evaluate(X_test, y_test)
```

- 학습할 때는 쓰지 않았던 `X_test`로 점수를 매깁니다. 이것이 모델의 진짜 실력(일반화 성능)입니다.

## 3. 요약

- **목표**: 이진 분류 + 데이터 분석 + 성능 검증
- **특징**: `pandas`와 시각화 도구 활용. **Train/Test 데이터 분리**를 통해 모델의 과적합(Overfitting)을 방지하고 객관적인 성능을 평가함.
