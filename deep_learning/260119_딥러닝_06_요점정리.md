# 데이터 전처리(Preprocessing) 및 회귀 모델(Regression)

**`260108 딥러닝 06.py`** 파일은 주택 가격 예측(House Price Prediction)을 위한 **회귀(Regression)** 예제입니다. 이 예제에서는 결측치 처리, 카테고리형 데이터 변환, 상관관계 분석 등 **체계적인 데이터 전처리** 과정을 거쳐 딥러닝 모델을 학습시킵니다.

## 1. 데이터 탐색 및 전처리 (Preprocessing)

데이터의 품질이 모델 성능을 결정합니다. 실제 데이터에는 누락된 값(결측치)이나 문자열 데이터가 포함되어 있어, 이를 딥러닝 모델이 학습할 수 있는 형태로 가공해야 합니다.

- **결측치(Missing Value) 처리**:
  - `df.isnull().sum()`: 결측치 확인
  - `df.fillna(df.mean())`: 결측치를 각 컬럼의 평균값으로 대체 (가장 보편적인 방법)
- **원-핫 인코딩(One-Hot Encoding)**:
  - `pd.get_dummies(df)`: 문자열(카테고리) 데이터를 0과 1의 수치 데이터로 변환 (예: 'TV', 'Radio' -> [1, 0], [0, 1])
- **상관관계 분석(Correlation)**:
  - `df.corr()`: 변수 간의 관계(영향력) 파악
  - 집값(`SalePrice`)과 상관관계가 높은 주요 속성만 추출하여 학습에 사용 (효율성 증대)

```python
# 상관관계 높은 상위 10개 출력
df_corr_sort = df_corr.sort_values('SalePrice', ascending=False)
print(df_corr_sort['SalePrice'].head(10))
```

## 2. 회귀 모델 설계 (Regression Model Architecture)

분류(Classification) 문제와 달리, 집값과 같은 **연속된 수치를 예측**하는 회귀 문제입니다.

- **출력층 특징**:
  - `Dense(1)`: 활성화 함수를 지정하지 않습니다. (또는 `activation='linear'`)
  - 값을 그대로 출력해야 하기 때문에 `sigmoid`나 `softmax` 같은 확률 활성화 함수를 사용하지 않습니다.
- **오차 함수(Loss Function)**:
  - `loss='mean_squared_error'`: 평균 제곱 오차(MSE)를 사용합니다. 예측값과 실제값의 차이의 제곱을 최소화하는 방향으로 학습합니다.

```python
model.add(Dense(1)) # 출력층 (활성화 함수 없음)
model.compile(optimizer='adam', loss='mean_squared_error')
```

## 3. 학습 및 시각화 (Visualization)

학습된 모델이 새로운 데이터에 대해 얼마나 집값을 잘 맞추는지 실제값과 예측값을 그래프로 비교하여 확인합니다.

- **예측 수행**: `model.predict(X_test).flatten()`으로 1차원 예측값 배열 생성
- **결과 비교**: `plt.plot()`을 사용하여 실제 가격과 예측 가격을 겹쳐 그려서 경향성 확인

```python
# 실제값 vs 예측값 비교 그래프
plt.plot(X_num, pred_prices, label='predicted price') # 예측 가격
plt.plot(X_num, real_prices, label='real price')      # 실제 가격
```

## 4. 실습 코드 흐름 요약

1.  **데이터 로드**: 주택 가격 데이터 로드 (`house_train.csv`)
2.  **전처리**:
    - 결측치 확인 및 평균값 대체
    - 문자열 데이터 원-핫 인코딩
3.  **속성 선택**: 상관관계 분석을 통해 집값에 영향이 큰 상위 5개 속성 선택
4.  **모델 학습**: 모델 체크포인트와 조기 종료를 적용하여 최적 모델 학습
5.  **예측 및 시각화**: 테스트 데이터에 대한 집값을 예측하고, 실제 가격과 비교 그래프 출력
