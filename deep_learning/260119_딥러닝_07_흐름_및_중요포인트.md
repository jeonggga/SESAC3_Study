# MNIST 손글씨 분류 코드 분석 보고서 (`260108 딥러닝 07.py`)

이 문서는 MNIST 데이터셋을 사용하여 손글씨 숫자를 분류하는 딥러닝 코드의 전체적인 흐름과 중요 포인트를 정리한 것입니다. 코드는 크게 **MLP(Multi-Layer Perceptron)** 모델과 **CNN(Convolutional Neural Network)** 모델 두 부분으로 나뉩니다.

---

## 1. 전체 코드 흐름 (Overall Flow)

### [Step 1] 라이브러리 임포트 및 설정

- TensorFlow Keras 모듈(`Sequential`, `Dense`, `Conv2D` 등)과 데이터 처리를 위한 `numpy`, 시각화를 위한 `matplotlib` 등을 불러옵니다.
- 시스템 경로(`os`, `sys`) 설정을 통해 파일 저장 위치 등을 관리합니다.

### [Step 2] 데이터 로드 및 탐색

- `mnist.load_data()`를 통해 60,000개의 학습 데이터와 10,000개의 테스트 데이터를 불러옵니다.
- 데이터의 형상(Shape)을 확인하고, 실제 이미지를 시각화하거나 픽셀 값을 숫자로 출력하여 데이터 구조를 파악합니다.

### [Step 3] MLP 모델 구현 (다층 퍼셉트론)

1.  **전처리 (Preprocessing)**
    - **Flattening (평탄화)**: 2차원 이미지(28x28)를 1차원 배열(784)로 변환합니다. (`reshape`)
    - **Normalization (정규화)**: 0~255 사이의 픽셀 값을 0~1 사이로 나눕니다. (`/ 255`)
    - **One-Hot Encoding**: 정답(Label)을 10개의 클래스 벡터로 변환합니다. (`to_categorical`)
2.  **모델 설계**: 은닉층(512노드) -> 출력층(10노드, Softmax)의 간단한 구조입니다.
3.  **학습 및 평가**: `adam` 옵티마이저와 `categorical_crossentropy` 손실 함수를 사용하여 학습하고 테스트 정확도를 출력합니다.

### [Step 4] CNN 모델 구현 (합성곱 신경망)

1.  **전처리 (Preprocessing)**
    - **Reshaping (차원 변경)**: Conv2D 레이어 입력을 위해 데이터를 (샘플수, 28, 28, 1) 형태의 4차원 텐서로 변환합니다.
    - 정규화 및 원-핫 인코딩은 MLP와 동일하게 수행합니다.
2.  **모델 설계**: `Conv2D` -> `MaxPooling2D` -> `Dropout` -> `Flatten` -> `Dense` 연결 구조로, 이미지의 공간적 특징을 추출하는 데 특화되어 있습니다.
3.  **학습 및 평가**: MLP와 동일한 설정으로 학습을 진행하며, 일반적으로 더 높은 정확도를 보여줍니다.

---

## 2. 주요 포인트 (Key Points)

### 🔑 데이터 전처리의 차이 (MLP vs CNN)

- **MLP**: 공간 정보를 무시하고 픽셀을 일렬로 늘어놓습니다. (`input_dim=784`)
- **CNN**: 이미지의 가로, 세로, 채널(흑백=1) 형태를 유지하여 **공간적 특징(Spatial Features)**을 학습합니다. (`input_shape=(28, 28, 1)`)

### 🔑 주요 레이어 설명

- **Conv2D**: 필터(커널)를 사용하여 이미지의 특징을 감지합니다.
- **MaxPooling2D**: 이미지 크기를 줄이면서 주요 특징만 남겨 연산량을 줄이고 과적합을 방지합니다.
- **Dropout**: 학습 시 일부 뉴런을 무작위로 꺼서(비활성화) 모델이 특정 뉴런에 의존하는 것을 막아 **과적합(Overfitting)을 강력하게 억제**합니다.
- **Softmax**: 출력층에서 사용하여 각 클래스(0~9)에 속할 확률을 반환합니다. (확률의 총합 = 1)

### 🔑 콜백(Callback) 함수 활용

- **ModelCheckpoint**: `val_loss`(검증 손실)가 개선될 때마다 모델을 파일로 저장하여, 과적합 되기 전의 **최적 모델**을 확보합니다.
- **EarlyStopping**: 학습이 더 이상 개선되지 않으면(patience=10) 불필요한 추가 학습을 멈춰 시간을 절약하고 과적합을 방지합니다.

### 🔑 경로 설정 (Path Handling)

- `os.path.dirname(__file__)`과 `os.path.join(..., "../data/model/...")`을 사용하여 실행 위치에 상관없이 안전하게 모델을 저장하고 불러오도록 처리되었습니다.
